{% extends 'base.html.twig' %}

{% block title %}Administration des Articles{% endblock %}

{% block body %}
    <twig:PageHeader
        title="Administration des Articles"
        subtitle="Gérez tous vos articles (publiés et brouillons)"
        :createPath="path('app_post_new')"
        createLabel="Nouvel Article"
    />

    <twig:AdminTable :headers="['Titre', 'Statut', 'Date de création', 'Actions']">
        <twig:block name="content">
            {% for post in posts %}
                <tr>
                    <td class="ps-4">
                        <div class="fw-bold text-dark">{{ post.title }}</div>
                        <div class="small text-muted text-truncate" style="max-width: 300px;">{{ post.subTitle }}</div>
                    </td>
                    <td>
                        {% if post.published %}
                            <span class="badge bg-success-subtle text-success px-3 rounded-pill">
                                <i class="bi bi-check-circle me-1"></i>Publié
                            </span>
                        {% else %}
                            <span class="badge bg-warning-subtle text-warning px-3 rounded-pill">
                                <i class="bi bi-pencil-square me-1"></i>Brouillon
                            </span>
                        {% endif %}
                    </td>
                    <td>
                        <div class="small text-muted">
                            <i class="bi bi-calendar3 me-1"></i>{{ post.createdAt|date('d/m/Y H:i') }}
                        </div>
                    </td>
                    <td class="text-end pe-4">
                        <div class="btn-group">
                            <a href="{{ path('app_post_show', {'slug': post.slug}) }}" class="btn btn-sm btn-outline-secondary" title="Voir">
                                <i class="bi bi-eye"></i>
                            </a>
                            <a href="{{ path('app_post_edit', {'id': post.id}) }}" class="btn btn-sm btn-outline-primary" title="Modifier">
                                <i class="bi bi-pencil"></i>
                            </a>
                            <form method="post" action="{{ path('app_post_delete', {'id': post.id}) }}" class="d-inline" onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer cet article ?');">
                                <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ post.id) }}">
                                <button class="btn btn-sm btn-outline-danger" title="Supprimer">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="4" class="text-center py-5 text-muted">
                        <i class="bi bi-journal-x display-4 mb-3 d-block"></i>
                        Aucun article trouvé.
                    </td>
                </tr>
            {% endfor %}
        </twig:block>
    </twig:AdminTable>
{% endblock %}
